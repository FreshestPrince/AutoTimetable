from tkinter import *
from tkinter.ttk import Button, Style
from random import choice, randint
import pandas as pd
from datetime import datetime, timedelta
from cal_setup import get_calendar_service

Course_Subjects = {
    'DT008/3B': [16580, 28822, 5298, 32835, 32834, 3739, 16586, 28818, 24003, 28865, 170818, 146195, 31186, 23741, 6547,
                 34386, 4458, 76826, 206123, 213473, 206124, 213468, 205669, 213472, 206125], 'DT002/3': [51186, 28424],
    'DT066/D2': [131754, 131752, 127163, 127164, 131125, 131126],
    'DT083/5': [145972, 95065, 95017, 122868, 53982, 185985], 'DT228/1G2': [92141],
    'DT211C/1A': [11542, 31162, 61787, 61956],
    'DT080A/1B': [84492, 62219, 62218, 60725, 16662, 59166, 59164, 59163, 59162, 59165, 5104, 75699, 22461, 81201,
                  22474, 41927, 6833, 62222, 105595, 207259, 89784, 68896, 22469, 60735, 62225, 4437, 60730, 62224,
                  62223], 'DT021A/3G': [62002, 72343, 72344], 'XDK39': [20417, 193899], 'DT228/1G4': [92124],
    'DT9420/1': [128742],
    'DT080A/1A': [84492, 62219, 62218, 62237, 62226, 60736, 59167, 59179, 4009, 4401, 190708, 112661, 60725, 16662,
                  59166, 59164, 59163, 59162, 59165, 5104, 75699, 22461, 81201, 22474, 41927, 6833, 62222, 105595],
    'SBE6/C_T2': [212408, 212409, 212392, 212393, 212394, 212322, 212323, 212324, 212325, 212410, 212405, 212398,
                  212400, 212404, 212402, 212403, 212401], 'DT033/3': [121884, 161763, 196134],
    'DT211C/3B': [162594, 162593],
    'DT035A/4': [206320, 133716, 213976, 69216, 146122, 146123, 146124, 213971, 105753, 105754, 141855, 128948, 127945,
                 141059, 206610, 108118, 108121, 214480, 214481, 108119, 108120, 95544, 95726, 60245, 89354, 206613,
                 206611, 89467, 172279, 172206, 213973, 213974, 106959, 155819, 104638, 206612],
    'DT021A/3C': [209182, 209262, 4066, 117156, 117155], 'DT211C/1C': [11542, 31162, 61787, 61956],
    'DT097A/1D': [208804, 208562, 186841, 186842, 186839, 186865],
    'SBE4/B_T3': [181566, 181559, 181560, 181564, 181563, 181558, 181549, 181569, 181565, 181561, 181568, 181573,
                  199243, 181571, 181572, 198303, 199473, 181574], 'DT228/4A': [173882],
    'DT078/3': [214224, 75915, 128702, 129121], 'DT083/5A': [127830],
    'DT008/2A': [210210, 206666, 118095, 32825, 131132, 32833, 29963, 29964, 32831, 63123, 4471, 32821, 4090, 3239,
                 5873, 6940, 32826, 32824, 131127, 131130, 28678, 34163, 25057, 29056, 6023, 3259, 4097, 28698, 32828,
                 32829, 4550, 38441, 61287, 4603], 'DT705/2': [116692, 171385, 171389, 171381, 171707],
    'DT021A/4G': [171901, 91706, 140565, 34857, 6047, 97166, 97165, 89991, 5965], 'DT228/1C': [28926, 195601],
    'SBE4/B_T1': [127937, 133385, 133383, 103836, 133384, 97482, 133382, 89765, 186118, 103835, 186139, 186135, 154116,
                  154117, 154118, 186133, 154112], 'DT005/3': [29533, 5892, 89070], 'DT211C/2G3': [156547],
    'DT008/3A': [7277, 177167, 16583, 51047, 7224, 75680, 74929, 16580, 28822, 5298, 32835, 32834, 3739, 16586, 28818,
                 24003, 28865, 170818, 146195, 31186, 23741, 6547, 34386, 4458, 76826],
    'DT021/4': [88814, 127651, 88813, 90482, 91763, 31177, 96478, 132057, 96424, 106818, 33484, 134577, 31176, 100226,
                123046, 133046, 133828, 145329, 194444, 82590, 50478, 50479, 6873, 25494, 56733, 110444, 161618, 193848,
                51407, 80369, 80459, 145238, 194406, 215051],
    'SBE6/B_T3': [198382, 198400, 198402, 198381, 198403, 198380, 198401, 198390, 198405, 198391, 198392, 198393,
                  198387, 198388, 198389, 198394, 193666],
    'DT010/3': [117846, 213960, 213964, 213965, 213961, 213967, 213966, 214028, 213962, 213968, 213969, 213970, 211396,
                211401, 207250, 186428, 186435, 185986, 186433, 90805, 186429, 76106, 90815, 186430, 127593, 90819],
    'SBE4/C_T1': [186177, 186174, 186140, 186141, 186142, 186175, 186119, 187997, 154113, 186176, 187993, 187998,
                  187999, 186173, 186172, 186136, 187994], 'DT002A/1A': [207454, 207455, 105365, 105366, 207453, 73474],
    'DT080A/2': [4851, 40979], 'DT223/1': [153214],
    'DT080A/3B': [89588, 212111, 134149, 95690, 209177, 90878, 93684, 203769, 203768, 59135, 59136, 122292, 127470,
                  213922, 211403, 212937, 132384, 132566, 212938, 134150, 114377, 203766, 203763, 92902],
    'DT711/1': [145823, 145824, 104024, 128022, 116692, 45386, 147654, 157796, 171381, 171707, 82589, 97336, 123784,
                129667, 141057, 133827, 123811, 133821], 'DT282/4': [110922, 173882, 204461, 204457],
    'DT211C/1T3': [204439, 61682],
    'DT021A/2C': [28456, 6361, 33886, 61940, 110507, 34122, 110726, 74050, 127806, 127807, 6642, 117667, 140446,
                  104760], 'DT228/1B': [28926, 195601],
    'SBE4/B_T2': [177924, 133386, 136228, 136236, 136234, 121162, 97488, 136237, 136230, 178909, 133375, 133374, 192468,
                  133377, 178102, 178103], 'DT282/3': [209443, 154501, 188116, 154500],
    'DT228/4': [110922, 204461, 204457], 'DT442T/1': [203832, 154689, 203833],
    'DT015/2': [145823, 145824, 104024, 128022, 116692, 45386, 147654, 157796, 171381, 171707],
    'DT009/2': [123048, 209128, 74855, 62258, 209129, 107679, 117133, 206358, 89517, 90525, 60759, 110503, 34140, 96455,
                88817, 96222, 41138, 50299, 61071, 24060, 67536, 67537, 104775, 107683, 147647, 81541, 96626, 90068,
                93457, 74395, 6261, 110501, 97837, 111677, 105374],
    'DT021A/3_3': [80898, 110988, 110451, 45442, 80897, 111217, 123760, 181158, 213996, 211248, 44870, 44869, 33916,
                   122307, 32772, 122314, 154845, 105181, 6325, 17894, 157401, 122313, 45443, 110292],
    'DT066/A1': [131754, 127108, 131122, 130810, 130811, 131752],
    'DT705/1': [145823, 128022, 179123, 174037, 171383, 174156, 171696, 103644],
    'DT015/3': [145823, 145824, 104024, 128022, 116692, 157796, 146034],
    'DT021A/4J': [173920, 171329, 169551, 171205, 68362, 171485, 171900, 169552, 169553],
    'DT035A/1': [161480, 161478, 161479, 161481, 161475, 178838, 154339, 154340, 154337, 154338, 213424, 213425, 75048,
                 105291, 145975, 145978, 161486, 161487, 161482, 161485, 134289, 95211, 25156, 133716, 62222, 105595],
    'DT021A/3J': [154822, 155272, 171107],
    'DT080B/4B': [207940, 161942, 161943, 161944, 161945, 161979, 161980, 161981, 161982, 117712, 55875, 117704, 117703,
                  171098, 172025, 117167, 117166, 128562, 128561, 117701, 117278, 117708, 204131, 138880],
    'SBE4/A_T3': [181551, 199242, 181554, 181552, 181556, 181555, 181557, 181566, 181559, 181560, 181564, 181563,
                  181558, 181549, 181569, 181565, 181561, 181568],
    'DT003A/1B': [177345, 6194, 209127, 207454, 207455, 105365, 105366, 207453, 73474, 179147],
    'DT021A/4D': [66426, 122503, 121693], 'DT021A/4E': [6601, 173904, 51199, 105509, 61268, 90687, 90688, 51196, 51195],
    'DT008/2': [21232, 3711],
    'DT080A/2B': [114544, 211402, 211395, 186004, 203805, 126384, 126382, 5206, 90314, 5135, 22511, 22512, 96576,
                  106097, 106098, 117296, 68899, 186011, 186012, 114550, 114545, 22531, 22510, 211398, 186007, 126386,
                  104677, 107172, 181982, 104678, 190712, 134262],
    'DT021A/3': [215051, 123748, 133817, 145924, 169532, 99354, 113906, 113908, 149514, 178644, 199181, 152373, 152372,
                 90773, 39702, 90263, 127600, 88415, 157399, 157400, 51988, 178646, 178648, 178650, 199180, 155202,
                 127330], 'DT022/3_A': [28197, 42983],
    'SBE6/D_T2': [212398, 212400, 212404, 212402, 212403, 212401, 212407, 212411, 212395, 212396, 212397, 212318,
                  212326, 212327, 212328, 212412, 212406], 'DT078/3A': [23472, 23469],
    'DT080A/3A': [215057, 134152, 212935, 212936, 132567, 132385, 90877, 203767, 203761, 92903, 89588, 212111, 134149,
                  95690, 209177, 90878, 93684, 203769, 203768, 59135, 59136, 122292, 127470],
    'DT080B/4A': [204132, 117280, 117169, 207940, 161942, 161943, 161944, 161945, 161979, 161980, 161981, 161982,
                  117712, 55875, 117704, 117703, 171098, 172025, 117167, 117166, 128562, 128561, 117701, 117278],
    'RDK39': [213415, 213419, 213420, 213421, 213422, 213416, 7051, 133136, 69072, 21971, 29342, 40465, 52550, 171723,
              194205, 194712, 194722, 208979, 212561, 213417, 3995, 5357, 29341, 52553, 55154, 55173, 129246, 140583,
              141520, 145473, 159007, 162142, 192727, 194710, 194714, 194715, 194716, 194718, 194719, 194720, 194723,
              194724, 203212, 203215, 203216, 203217, 211330, 4877, 5874, 20428, 117360, 125026, 141046, 141519, 149096,
              155047, 182819, 184103, 194206, 194207, 194717, 194721, 203210, 203211, 203214, 213418, 49538],
    'DT078/2C': [41125, 134534],
    'DT009/1': [6591, 6037, 154875, 154877, 154876, 158663, 158662, 4112, 128161, 110156, 50458, 171778, 89424, 122530,
                74619, 158666, 213298, 154873, 158665, 188611, 123048, 23013, 18734, 5102],
    'DT066/E1': [131754, 131755, 127163, 127165, 130813], 'DT282/1': [134052],
    'SBE6/A_T3': [198398, 198399, 198383, 198384, 198385, 198395, 198396, 198397, 198386, 198404, 198382, 198400,
                  198402, 198381, 198403, 198380, 198401],
    'SBE6/B_T1': [127961, 140796, 106227, 107473, 117405, 107476, 186970, 186234, 68786, 140793, 186386, 140789, 140790,
                  140791, 140786, 140787, 186192, 186196, 188331], 'DT8265-A': [134052], 'DT097A/1': [108142, 117283],
    'DT260/3': [19268, 18287, 74166],
    'DT080A/2A': [211399, 186005, 126385, 6473, 22525, 18727, 22539, 190713, 68901, 114544, 211402, 211395, 186004,
                  203805, 126384, 126382, 5206, 90314, 5135, 22511, 22512, 96576, 106097, 106098, 117296, 68899, 186011,
                  186012, 114550, 114545, 22531, 22510], 'DT436T/1ER': [203832, 154689, 203833],
    'DT003A/1A': [177345, 6194, 209127, 207454, 207455, 105365, 105366, 207456, 24905, 24773, 45549, 34866],
    'DT035A/2': [178916, 127941, 188954, 214096, 128913, 127939, 175888, 175889, 133716, 178939, 172040, 178941, 178940,
                 175897, 189451, 179025, 171541, 89783, 89735, 179710, 195000, 175887, 195001, 128914, 89203, 211396,
                 211401, 84492, 62219, 62218], 'DT066/C2': [131754, 131755, 127163, 154888, 127134, 130812],
    'DT211C/2B': [3284, 74809, 61952, 40350, 61720], 'DT211C/2G1': [90582], 'DT022/3_B': [42983], 'DT080A/1': [4851],
    'SBE4/A_T1': [186113, 5930, 128186, 128187, 128185, 127936, 105926, 127937, 133385, 133383, 103836, 133384, 97482,
                  133382, 89765, 186118, 103835],
    'DT086/1': [40693, 132994, 158719, 51553, 158873, 174338, 211088, 174016, 51551, 40692, 45517, 40690, 40691, 158857,
                44908, 159055, 49970, 49972],
    'DT080A/3C': [212111, 134149, 95690, 209177, 90878, 93684, 203769, 203768, 59135, 59136, 122292, 127470, 211400,
                  212939, 212940, 132565, 132381, 134153, 114376, 203764, 203762, 120442, 114352],
    'DT021A/2B': [28455, 145526, 4279, 104207, 28456, 6361, 33886, 61940, 110507, 34122, 110726, 74050, 61659, 6150,
                  130028, 33887, 130006, 67533, 140445, 117134, 213462, 127807],
    'DT221/4': [108118, 108121, 214480, 214481, 108119, 108120, 95544, 95726, 60245, 89354],
    'DT066/D1': [131754, 131755, 127163, 127120, 127164, 131125], 'DT066/F1': [131754],
    'DT021A/3A': [140558, 156264, 74950, 104761], 'DT066Full': [4430, 127168, 131754], 'DT228/1D': [28926, 195601],
    'DT021A/3_2': [159025, 80898, 110988, 110451, 45442, 80897, 211250, 96252, 122495, 96285, 96418, 96417, 122321,
                   156259, 152375, 39849, 74955, 111217, 123760, 122313, 45443, 110292],
    'DT704/1': [145823, 128022, 116692, 147654, 193505, 199515, 195348, 204790, 199344, 199514, 162667, 179123, 174037,
                171383, 174156, 171696, 103644, 171385, 171389, 171381, 171707],
    'DT021A/4H': [34857, 6047, 97166, 97165, 89991, 5965, 186405, 190661, 186406], 'DT021A/3E': [40822, 19985, 51184],
    'DT026/4': [156623, 29096, 4739], 'DT021A/4_2': [171321, 171323, 171325, 171327, 171322, 171324, 171326, 171328],
    'DT022/3_C': [42983],
    'DT021A/4B': [179476, 78963, 68657, 122744, 78962, 123043, 54944, 169556, 171791, 169560, 169559],
    'DT080A/1C': [84492, 62219, 62218, 60725, 16662, 59166, 59164, 59163, 59162, 59165, 5104, 75699, 22461, 81201,
                  22474, 41927, 6833, 62222, 105595, 190709, 104203, 89787, 61217, 186013, 89785, 89788, 59176, 186014],
    'DT002A/1': [177345, 6194, 209127, 179147],
    'DT021A/4F': [105509, 61268, 90687, 90688, 51196, 51195, 75714, 173923, 171330],
    'DT021A/4A': [155488, 42392, 179476, 78963, 68657, 122744, 78962, 123043, 54944, 169556, 171791],
    'DT8265-B': [134052], 'DT008/1': [4573, 21232],
    'DT015/1': [174150, 203666, 145823, 145824, 104024, 128022, 116692, 45386, 147654, 171381, 171707],
    'DT299T/1': [5633], 'DT021A/3H': [72343, 72344],
    'DT097A/1B': [186851, 208561, 155924, 173739, 110063, 186867, 44848, 54894, 81823],
    'DT7013/2': [29533, 5892, 89070],
    'DT021A/2': [75054, 127585, 30340, 7103, 140443, 140300, 127598, 129434, 3431, 215051],
    'DT021A/4_4': [110922, 173882], 'DT299T/4': [153446], 'DT436T/1HS': [203832, 154689, 203833],
    'DT008/2B': [63123, 4471, 32821, 4090, 3239, 5873, 6940, 32826, 32824, 131127, 131130, 28678, 34163, 25057, 29056,
                 6023, 3259, 4097, 28698, 32828, 32829, 4550, 38441, 61287, 4603, 210223, 59150, 61109, 194448, 156614,
                 156610, 59149, 59148, 156611], 'DT018/2': [104644, 104806, 54136, 99652, 133813, 146125, 79812],
    'DT008/3': [21232, 42092, 75954, 75946, 75949, 75952, 175893, 22955], 'DT228/1': [104957, 105121, 62780],
    'DT066/C1': [131754, 131752, 209210, 127127, 127331, 127135, 127163], 'DT705/3': [171726, 186404, 192726],
    'DT066/A2': [131754, 130810, 130811, 131752, 126057],
    'DT086/1A': [205761, 205762, 205082, 129508, 205631, 205623, 205640, 205622, 117188, 205088, 205096, 205638, 40565,
                 205644],
    'SBE6/B_T2': [193573, 193584, 193586, 193588, 193574, 193585, 212399, 193598, 193593, 193594, 193595, 193596,
                  193590, 193591, 193592, 193575, 193597, 193599], 'DT005A/2': [164275, 121884],
    'DT097A/1A': [144995, 196518, 110062, 116711, 116852, 117287, 212813, 110520, 186851], 'DT211C/1T2': [90064],
    'DT6012': [173538, 173542, 182833, 173535, 178853, 182832, 173537, 178844, 173539, 178846, 173540, 178849, 182838,
               173541, 178850, 182840, 173534, 178855, 178854, 206614, 178857, 182842, 178859, 182843, 173543, 182836,
               173544, 182837, 178851, 182839, 178852, 182841, 182844, 173536, 178856], 'DT066/E2': [131754, 131755],
    'DT080B/4': [117168, 173148, 117451, 117659, 130443, 147919, 162208, 128055, 147920, 117661, 6182],
    'SBE4/A_T2': [133403, 136229, 133381, 133404, 212228, 121163, 178100, 177924, 133386, 136228, 136236, 136234,
                  121162, 97488, 136237, 136230, 178909],
    'SBE6/A_T2': [193583, 193571, 193576, 193577, 193578, 193580, 193581, 193582, 212321, 193579, 193589, 193573,
                  193584, 193586, 193588, 193574, 193585, 212399], 'DT228/1A': [28926, 195601], 'DT066/F2': [131754],
    'DT022/3_D': [42983], 'DT026/3': [189260, 189259],
    'DT097A/1C': [104564, 171690, 140663, 116715, 116848, 116862, 193547],
    'DT211C/2A': [103129, 3284, 74809, 61952, 40350], 'DT021A/3F': [19985, 51184, 6019], 'DT228/1G3': [112487],
    'DT225/1': [153214], 'DT021A/3B': [156263], 'DT021A/4_5': [186152, 186154], 'DT211C/3A': [103295, 162594, 162593],
    'DT010/2': [117846, 195004, 195005, 195008, 195006, 203738, 186425, 178916, 127941, 188954, 214096, 128913, 127939,
                175888, 175889, 189451, 179025, 171541, 89783, 89735, 179710, 195000, 175887, 195001, 128914, 89203],
    'DT080A/2C': [211402, 211395, 186004, 203805, 126384, 126382, 5206, 90314, 5135, 22511, 22512, 96576, 106097,
                  106098, 117296, 68899, 186011, 186012, 114550, 114545, 22531, 22510, 211397, 186008, 126389, 104791,
                  104840, 181983, 104793, 190711, 114546, 107170], 'DT211C/1': [134052],
    'DT066/B1': [131754, 130810, 130811, 131121, 131755], 'DT211C/4': [110922, 204461, 204457],
    'DT010/1': [6591, 6037, 154875, 154877, 154876, 158663, 158662, 4112, 128161, 110156, 50458, 171778, 89424, 122530,
                23013, 18734, 5102, 186080, 194496, 213299, 186085, 186086, 117846], 'DT235/4': [50513],
    'DT078/2A': [134533, 41125], 'DT203A/1': [5633], 'DT021A/4C': [78959, 66426, 122503],
    'DT078/2B': [41125, 23367, 121615, 134535],
    'DT035A/3': [133716, 195257, 195259, 195262, 195266, 195269, 186381, 187835, 186379, 186229, 186975, 203668, 207250,
                 186428, 186435, 185986, 186433, 90805, 186429, 76106, 90815, 186430, 127593, 90819],
    'DT9419/1': [128742],
    'DT021A/2A': [105635, 62590, 74774, 3901, 140904, 60146, 34404, 140444, 4229, 143092, 28455, 145526, 4279, 104207,
                  28456, 6361, 33886, 61940, 110507, 34122, 110726, 74050, 127806],
    'SBE4/D_T1': [187997, 154113, 186176, 187993, 187998, 187999, 186173, 186172, 186136, 187994, 203378, 203375,
                  203224, 203225, 203226, 203376, 203377],
    'SBE6/A_T1': [185975, 107475, 127829, 127827, 127828, 129065, 129066, 129064, 185973, 127961, 140796, 106227,
                  107473, 117405, 107476, 186970, 186234, 68786],
    'SBE6/C_T3': [198408, 198418, 198420, 198416, 198407, 198417, 198412, 198413, 198414, 198409, 198410, 198411,
                  198421, 198406, 198419, 198415, 198422], 'DT211C/1B': [11542, 31162, 61787, 61956],
    'DT211C/1T1': [204437, 18529],
    'DT009/3': [123048, 122510, 110839, 110228, 140238, 186091, 104728, 103642, 186092, 42393, 154867, 104896, 141044,
                122505, 103035, 89544, 121691, 105653, 128607, 104733, 104715, 117140, 123780, 174035, 105303, 74466,
                35940, 123045, 145518, 28761], 'DT066/B2': [131754, 130810, 130811, 131121, 131755],
    'DT086/1B': [205622, 117188, 205088, 205096, 205638, 40565, 205644, 205639, 205760, 205621, 205624, 205632, 117190,
                 205641], 'DT018/1': [43740, 198529, 90572, 95447, 206315, 83702, 206320, 73574], 'DT211C/2G2': [30145],
    'DT083/4': [76439, 185977, 76440, 95041, 54661, 145972], 'DT078/2': [68893, 129121],
    'DT080A/3': [4851, 207745, 90297],
    'DT008/1A': [22558, 6975, 23015, 188621, 212927, 6591, 6037, 154875, 154877, 154876, 158663, 158662, 4112, 128161,
                 110156, 50458, 171778, 89424, 122530], 'DT006/3B': [142839],
    'DT211C/2C': [3284, 74809, 61952, 40350, 170723], 'DT211C/4A': [173882],
    'DT712/4': [206320, 73574, 105753, 105754, 141855, 128948, 127945, 141059, 206610, 108118, 108121, 214480, 214481,
                108119, 108120, 95544, 95726, 60245, 89354, 213975, 67660, 97204, 133606, 146127, 110064, 121255,
                146033, 146129, 206613, 206611, 89467, 172279, 172206, 213973, 213974, 106959, 155819, 104638, 206612],
    'DT260/2': [69621, 172195, 172630, 146465, 15139, 28755, 5275],
    'DT021A/4Y': [105509, 61268, 90687, 90688, 51196, 51195, 169557, 173922, 171893], 'DT078/3B': [23469, 121613],
    'DT083/4A': [89349],
    'nan': [123610, 205763, 205766, 206060, 206061, 156270, 156271, 156274, 156275, 81273, 192381, 203806, 203807,
            205278, 163983, 60149, 141042, 162048, 191105, 5972, 175892, 146463, 140780],
    'DT021A/3_1': [211251, 96257, 96253, 80365, 80270, 122311, 122316, 156261, 152374, 74566, 140546, 159025, 80898,
                   110988, 110451, 45442, 80897, 111217, 123760, 122313, 45443, 110292]}
lectures = [3284, 74809, 61952, 40350, 170723, 214096, 89783, 179025, 89203, 195000, 84492, 198401, 198393, 198391,
            198380, 198405, 198390, 131754, 130810, 130811, 131752, 126057, 131754, 131755, 127163, 127120, 127164,
            131125, 78959, 66426, 122503, 173882, 128742, 173882, 60736, 112661, 59166, 62222, 59163, 16662, 190711,
            203805, 114550, 68899, 22511, 22531, 21232, 3711, 186173, 186172, 154113, 187994, 187993, 187999, 186118,
            103836, 154117, 154116, 89765, 133383, 207456, 207455, 45549, 177345, 207454, 6194, 40822, 19985, 51184,
            104957, 105121, 62780, 4458, 31186, 16583, 75680, 74929, 34386, 131754, 127108, 131122, 130810, 130811,
            131752, 153446, 131754, 28926, 195601, 22531, 114545, 22525, 5135, 186004, 211402, 41125, 23367, 121615,
            134535, 153214, 193596, 193574, 193595, 193590, 193585, 193594, 11542, 31162, 61787, 61956, 134052, 198402,
            198395, 198404, 198386, 198382, 198381, 208804, 208562, 186841, 186842, 186839, 186865, 131754, 131755,
            127163, 154888, 127134, 130812, 51195, 105509, 90687, 173904, 6601, 90688, 106097, 96576, 186012, 114550,
            107172, 114544, 103129, 3284, 74809, 61952, 40350, 116692, 171385, 171389, 171381, 171707, 205088, 205631,
            205623, 129508, 205762, 205096, 189260, 189259, 29533, 5892, 89070, 89349, 3284, 74809, 61952, 40350, 61720,
            110922, 204461, 204457, 90064, 42983, 66426, 122503, 121693, 203761, 93684, 134152, 212935, 212111, 212936,
            207454, 207455, 105365, 105366, 207453, 73474, 153214, 51186, 28424, 23469, 121613, 4851, 204439, 61682,
            131754, 131755, 127163, 127165, 130813, 134577, 127651, 110444, 194444, 91763, 106818, 108120, 95726, 89354,
            108118, 214481, 108119, 92124, 122495, 96285, 45443, 96417, 159025, 122321, 110507, 6642, 34122, 117667,
            6361, 28456, 140558, 156264, 74950, 104761, 171324, 171327, 171322, 171325, 171323, 171321, 68657, 42392,
            179476, 78963, 54944, 171791, 4430, 127168, 131754, 134052, 29533, 5892, 89070, 107476, 188331, 107473,
            140787, 106227, 127961, 28926, 195601, 175888, 195004, 203738, 127939, 117846, 175887, 91706, 171901, 97165,
            140565, 5965, 6047, 158663, 6975, 4112, 6037, 110156, 6591, 104564, 116715, 140663, 193547, 116862, 171690,
            212404, 212406, 212402, 212401, 212398, 212327, 15139, 28755, 172630, 146465, 5275, 172195, 206320, 141855,
            146129, 213975, 121255, 95544, 156263, 34122, 33887, 28455, 28456, 61659, 110507, 185986, 211396, 213969,
            213964, 213962, 186428, 209443, 154501, 188116, 154500, 21232, 42092, 175893, 75952, 22955, 75946, 121884,
            161763, 196134, 5633, 128742, 212111, 211403, 89588, 122292, 90878, 212938, 95211, 105595, 161481, 134289,
            154340, 161482, 204437, 18529, 147654, 128022, 82589, 145824, 133821, 145823, 145972, 95065, 95017, 122868,
            53982, 185985, 6591, 50458, 6037, 158662, 158665, 23013, 92141, 49972, 44908, 174338, 174016, 49970, 51551,
            52553, 184103, 20428, 29342, 194722, 194205, 62219, 59163, 75699, 59162, 6833, 89788, 103295, 162594,
            162593, 178909, 177924, 136234, 133404, 212228, 133381, 19985, 51184, 6019, 28197, 42983, 186851, 116711,
            110062, 117287, 212813, 144995, 4851, 40979, 11542, 31162, 61787, 61956, 59162, 75699, 60730, 105595, 68896,
            62225, 131127, 32828, 6940, 118095, 32824, 28678, 213473, 32834, 206125, 34386, 31186, 24003, 17894, 45442,
            44869, 110988, 213996, 181158, 128185, 128186, 133382, 133384, 127936, 128187, 110922, 204461, 204457,
            134153, 132565, 203764, 212940, 59136, 203762, 90582, 68893, 129121, 131754, 131755, 136228, 192468, 178909,
            133375, 178103, 136237, 154822, 155272, 171107, 146034, 145824, 145823, 116692, 104024, 157796, 171900,
            171205, 171329, 171485, 173920, 68362, 156623, 29096, 4739, 90805, 186433, 90819, 195266, 186429, 186428,
            212323, 212405, 212394, 212325, 212392, 212400, 42983, 110922, 173882, 204461, 204457, 74050, 4279, 33886,
            62590, 74774, 127806, 28926, 195601, 171791, 169556, 179476, 123043, 122744, 78963, 141044, 74466, 105653,
            123048, 110839, 186091, 110922, 173882, 162208, 147919, 173148, 117659, 117451, 147920, 134052, 203832,
            154689, 203833, 105365, 73474, 6194, 207455, 177345, 207453, 72343, 72344, 186405, 89991, 5965, 34857,
            190661, 97166, 162594, 162593, 79812, 99652, 104806, 146125, 104644, 54136, 157796, 171707, 45386, 145823,
            145824, 171381, 76439, 185977, 76440, 95041, 54661, 145972, 181568, 181565, 181560, 199473, 181549, 181559,
            209182, 209262, 4066, 117156, 117155, 23472, 23469, 156547, 62002, 72343, 72344, 108142, 117283, 19268,
            18287, 74166, 127830, 28926, 195601, 193574, 193577, 193578, 193583, 193582, 193586, 105509, 75714, 51196,
            51195, 90687, 61268, 198408, 198414, 198410, 198417, 198407, 198422, 186152, 186154, 142839, 131754, 130810,
            130811, 131121, 131755, 30340, 75054, 7103, 129434, 127598, 3431, 177345, 6194, 209127, 179147, 41125,
            134534, 131130, 4550, 28698, 6023, 3259, 4603, 171383, 199344, 162667, 171707, 103644, 171696, 112487,
            134052, 140796, 127827, 68786, 186234, 107476, 127829, 50513, 23013, 154877, 117846, 6037, 154875, 171778,
            89467, 127945, 146123, 133716, 214480, 206320, 131754, 30145, 127127, 127135, 209210, 127163, 131754,
            131752, 182841, 182840, 182842, 173541, 178852, 182836, 178648, 123748, 199180, 113908, 113906, 88415,
            122316, 110451, 211251, 45442, 74566, 159025, 181564, 181558, 181557, 181549, 199242, 181568, 111677,
            110503, 104775, 110501, 97837, 6261, 171726, 186404, 192726, 203832, 154689, 203833, 145823, 171696, 103644,
            128022, 179123, 171383, 145823, 174150, 203666, 147654, 171707, 171381, 4851, 207745, 90297, 134533, 41125,
            4573, 21232, 161943, 117167, 161979, 117701, 128562, 161981, 117701, 117704, 207940, 172025, 161944, 161942,
            42983, 169557, 173922, 90688, 105509, 61268, 51196, 206320, 206315, 73574, 95447, 83702, 90572, 205622,
            205088, 205639, 117190, 117188, 205624, 20417, 193899, 206061, 203807, 156270, 175892, 140780, 81273, 11542,
            31162, 61787, 61956, 208561, 173739, 186867, 44848, 54894, 155924, 203832, 154689, 203833, 164275, 121884,
            214224, 75915, 128702, 129121, 131754, 130810, 130811, 131121, 131755, 5633, 154113, 186176, 186141, 186136,
            186175, 186142, 131754, 131752, 127163, 127164, 131125, 131126]


class ScrollableFrame(Frame):
    def __init__(self, container, *args, **kwargs):
        super().__init__(container, *args, **kwargs)
        canvas = Canvas(self)
        scrollbar = Scrollbar(self, orient="vertical", command=canvas.yview)
        self.scrollable_frame = Frame(canvas)

        self.scrollable_frame.bind(
            "<Configure>",
            lambda e: canvas.configure(
                scrollregion=canvas.bbox("all")
            )
        )

        canvas.create_window((0, 0), window=self.scrollable_frame, anchor="nw")

        canvas.configure(yscrollcommand=scrollbar.set)

        canvas.pack(side="left", fill="both", expand=True)
        scrollbar.pack(side="right", fill="y")


def time_normal(number):
    while 0 < number > 12:
        number -= 13
    if number == 0:
        return 9
    elif number == 1:
        return 10
    elif number == 2:
        return 11
    elif number == 3:
        return 12
    elif number == 4:
        return 13
    elif number == 5:
        return 14
    elif number == 6:
        return 15
    elif number == 7:
        return 16
    elif number == 8:
        return 17
    elif number == 9:
        return 18
    elif number == 10:
        return 19
    elif number == 11:
        return 20
    elif number == 12:
        return 21


def make_date(number, start_day):
    day, time = time_translate(number, hours_in_day).split("-")
    if day == "Monday":
        start_day += 0
        return start_day, int(time)
    elif day == "Tuesday":
        start_day += 1
        return start_day, int(time)
    elif day == "Wednesday":
        start_day += 2
        return start_day, int(time)
    elif day == "Thursday":
        start_day += 3
        return start_day, int(time)
    elif day == "Friday":
        start_day += 4
        return start_day, int(time)


def create_event(start_date, time, lecture, description, finish_date, location, color):
    service = get_calendar_service()
    print(start_date, time)
    tomorrow = datetime(start_date[0], start_date[1], start_date[2], time - 1)
    start = tomorrow.isoformat()
    end = (tomorrow + timedelta(hours=1)).isoformat()
    event_result = service.events().insert(calendarId='primary',
                                           body={
                                               "summary": lecture,
                                               'location': location,
                                               "description": description,
                                               "start": {"dateTime": start, "timeZone": 'Etc/GMT+0'},
                                               "end": {"dateTime": end, "timeZone": 'Etc/GMT+0'},
                                               'recurrence': [finish_date],
                                               "colorId": color,
                                               "reminders": {
                                                   "useDefault": "useDefault",
                                                   # Overrides can be set if and only if useDefault is false.
                                                   'overrides': [
                                                       {'method': 'email', 'minutes': 24 * 60},
                                                       {'method': 'popup', 'minutes': 10},
                                                   ]
                                               },
                                           }
                                           ).execute()
    print("created event")
    print("id: ", event_result['id'])
    print("summary: ", event_result['summary'])
    print("starts at: ", event_result['start']['dateTime'])
    print("ends at: ", event_result['end']['dateTime'])


def time_normal(number, hours_in_day):
    while 0 < number > hours_in_day - 1:
        number -= hours_in_day
    if number == 0:
        return 9
    elif number == 1:
        return 10
    elif number == 2:
        return 11
    elif number == 3:
        return 12
    elif number == 4:
        return 13
    elif number == 5:
        return 14
    elif number == 6:
        return 15
    elif number == 7:
        return 16
    elif number == 8:
        return 17
    elif number == 9:
        return 18
    elif number == 10:
        return 19
    elif number == 11:
        return 20
    elif number == 12:
        return 21


def time_translate(number, hours_in_day):
    if number < hours_in_day:
        return "Monday" + "-" + str(time_normal(number, hours_in_day))
    elif hours_in_day * 2 > number:
        return "Tuesday" + "-" + str(time_normal(number, hours_in_day))
    elif hours_in_day * 3 > number:
        return "Wednesday" + "-" + str(time_normal(number, hours_in_day))
    elif hours_in_day * 4 > number:
        return "Thursday" + "-" + str(time_normal(number, hours_in_day))
    elif hours_in_day * 5 > number:
        return "Friday" + "-" + str(time_normal(number, hours_in_day))
    else:
        print("Value is not within proper range")
        return 0


def create_window(Lecture):
    New_Window = Tk()
    Columns = ["Lecturer:", "Classroom:", "Lecture:", "Course:", "Room Size:"]
    if type(Lecture) != list:
        lbl = Label(New_Window, text=Lecture, font=("Arial Bold", 30))
        lbl.grid(column=0, row=0)
    else:
        rows = 5
        columns = 2
        for x in range(columns):
            for y in range(rows):
                if x == 0:
                    text = Columns[y]
                else:
                    text = Lecture[y]
                btn = Label(New_Window, text=text)
                btn.grid(column=x, row=y, sticky="NSEW")
                Grid.columnconfigure(New_Window, x, weight=1)
                Grid.rowconfigure(New_Window, y, weight=1)
    New_Window.mainloop()


def save_on_google(course):
    lst = list(Course_Subjects.keys())
    thecourse = course
    new_data = {}
    df = pd.read_excel("tt.xlsx")
    for i in range(len(lst)):
        course = lst[i]
        subjects = Course_Subjects[course]
        new_df = df[df.Lecture_ID.isin(subjects)]
        new_data.update({course: new_df.to_dict("list")})
    finish_date = 'RRULE:FREQ=WEEKLY;UNTIL=20200529'
    location = "TU Dublin Kevin Street, Kevin Street, Portobello, Dublin 2, D08 X622, Ireland"
    lecture_dict = {}
    course = thecourse
    for i in range(len(new_data[course]["Time"])):
        start_day = 20
        Lecture = new_data[course]["Lecture"][i]
        Classroom = new_data[course]["Room"][i]
        Lecturer = new_data[course]["Lecturer"][i]
        number = new_data[course]["Time"][i]
        color = randint(1, 11)
        description = "Classroom-" + str(Classroom) + "\n" + "Lecturer-" + str(Lecturer)
        start_day, time = make_date(number, start_day)
        start_date = (2020, 4, start_day)
        lecture_dict.update({Lecture: number})
        create_event(start_date, time, Lecture, description, finish_date, location, color)


def onClick(idx):
    New_Window = Tk()
    style.theme_use("clam")
    course = (btn_list[idx].cget("text"))  # Print the text for the selected button
    time = 0
    index = 0
    rows = 13
    columns = 5
    grid = Frame(New_Window)
    Grid.rowconfigure(grid, rows, weight=1)
    Grid.columnconfigure(grid, columns, weight=1)
    grid.grid(row=0, column=0, sticky=N + S + E + W)
    subject_colours = {}
    for x in range(columns):
        for y in range(rows):
            if time in new_data[course]["Time"]:
                Lecture = new_data[course]["Lecture"][index]
                Classroom = new_data[course]["Room"][index]
                Lecturer = (new_data[course]["Lecturer"][index])
                Course = (new_data[course]["Course(s)"][index])
                Room_Size = (new_data[course]["Room Size"][index])
                info = [Lecturer, Classroom, Lecture, Course, Room_Size]
                lst = [Lecture, "\n", Classroom]
                text = ''.join(str(element) + ' ' for element in lst)
                index += 1
                fg_colour = "white"
                if Lecture not in list(subject_colours.keys()):
                    bg_colour = choice(colours)
                    subject_colours.update({Lecture: bg_colour})
                else:
                    bg_colour = subject_colours[Lecture]
            else:
                text = "\n"
                info = "There is no lecture at this time."
                bg_colour = "white"
                fg_colour = "black"
            Style().configure('styling.TButton', foreground=fg_colour, background=bg_colour)
            text = str(time_translate(time, hours_in_day)) + "\n" + text
            btn = Button(New_Window, text=text, command=lambda idx=info: create_window(idx), style='styling.TButton')
            btn.grid(column=x, row=y, sticky="NSEW")
            a = Button(New_Window, text="Save in Google Calendar", command=lambda idx=course: save_on_google(idx),
                       style='styling.TButton')
            a.grid(column=columns+1, row=6, sticky="NSEW")
            Grid.columnconfigure(New_Window, x, weight=1)
            Grid.rowconfigure(New_Window, y, weight=1)
            time += 1
    New_Window.mainloop()


def on_configure(event):
    canvas.configure(scrollregion=canvas.bbox('all'))


root = Tk()
# frame = ScrollableFrame(root)
hours_in_day = 13
df = pd.read_excel("tt.xlsx")
lists = df.to_dict("list")
btn_list = []  # List to hold the button objects
new_data = {}
number_name = {}
lst = sorted(list(Course_Subjects.keys()))

canvas = Canvas(root)
canvas.pack(side=LEFT)

scrollbar = Scrollbar(root, command=canvas.yview)
scrollbar.pack(side=LEFT, fill='y')
canvas.configure(yscrollcommand=scrollbar.set)
canvas.bind('<Configure>', on_configure)

i = 0
colours = list(pd.read_csv("colours.csv").columns)
style = Style(root)

style.theme_use("clam")
root.config(bg="cornflowerblue")
style.configure(root, background="cornflowerblue", fieldbackground="cornflowerblue", foreground="white")
frame = Frame(canvas)
canvas.create_window((0,0), window=frame, anchor='nw')
for i in range(len(lst)):
    course = lst[i]
    subjects = Course_Subjects[course]
    new_df = df[df.Lecture_ID.isin(subjects)]
    new_data.update({course: new_df.to_dict("list")})
    b = Button(frame, text=course, command=lambda idx=i: onClick(idx))
    b.pack(padx=10, pady=5, side=TOP)
    btn_list.append(b)  # Append the button to a list
root.attributes('-transparent', True)
root.mainloop()
